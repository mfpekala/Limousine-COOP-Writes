==5920== Memcheck, a memory error detector
==5920== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==5920== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info
==5920== Command: ./build/Playground
==5920== Parent PID: 5919
==5920== 
--5920-- 
--5920-- Valgrind options:
--5920--    --leak-check=full
--5920--    --show-leak-kinds=all
--5920--    --track-origins=yes
--5920--    --verbose
--5920--    --log-file=valgrind-out.txt
--5920-- Contents of /proc/version:
--5920--   Linux version 5.10.124-linuxkit (root@buildkitsandbox) (gcc (Alpine 10.2.1_pre1) 10.2.1 20201203, GNU ld (GNU Binutils) 2.35.2) #1 SMP Thu Jun 30 08:19:10 UTC 2022
--5920-- 
--5920-- Arch and hwcaps: AMD64, LittleEndian, amd64-cx16-lzcnt-sse3-avx-avx2-bmi
--5920-- Page sizes: currently 4096, max supported 4096
--5920-- Valgrind library directory: /usr/lib/valgrind
--5920-- Reading syms from /playground/src/build/Playground
--5920-- Reading syms from /lib/x86_64-linux-gnu/ld-2.27.so
--5920--   Considering /lib/x86_64-linux-gnu/ld-2.27.so ..
--5920--   .. CRC mismatch (computed 2977d8b2 wanted c64f09ed)
--5920--   Considering /usr/lib/debug/lib/x86_64-linux-gnu/ld-2.27.so ..
--5920--   .. CRC is valid
--5920-- Reading syms from /usr/lib/valgrind/memcheck-amd64-linux
--5920--   Considering /usr/lib/valgrind/memcheck-amd64-linux ..
--5920--   .. CRC mismatch (computed 41ddb025 wanted 9972f546)
--5920--    object doesn't have a symbol table
--5920--    object doesn't have a dynamic symbol table
--5920-- Scheduler: using generic scheduler lock implementation.
--5920-- Reading suppressions file: /usr/lib/valgrind/default.supp
==5920== embedded gdbserver: reading from /tmp/vgdb-pipe-from-vgdb-to-5920-by-???-on-61fd8e8ff218
==5920== embedded gdbserver: writing to   /tmp/vgdb-pipe-to-vgdb-from-5920-by-???-on-61fd8e8ff218
==5920== embedded gdbserver: shared mem   /tmp/vgdb-pipe-shared-mem-vgdb-5920-by-???-on-61fd8e8ff218
==5920== 
==5920== TO CONTROL THIS PROCESS USING vgdb (which you probably
==5920== don't want to do, unless you know exactly what you're doing,
==5920== or are doing some strange experiment):
==5920==   /usr/lib/valgrind/../../bin/vgdb --pid=5920 ...command...
==5920== 
==5920== TO DEBUG THIS PROCESS USING GDB: start GDB like this
==5920==   /path/to/gdb ./build/Playground
==5920== and then give GDB the following command
==5920==   target remote | /usr/lib/valgrind/../../bin/vgdb --pid=5920
==5920== --pid is optional if only one valgrind process is running
==5920== 
--5920-- REDIR: 0x4020d20 (ld-linux-x86-64.so.2:strlen) redirected to 0x580608c1 (???)
--5920-- REDIR: 0x4020b00 (ld-linux-x86-64.so.2:index) redirected to 0x580608db (???)
--5920-- Reading syms from /usr/lib/valgrind/vgpreload_core-amd64-linux.so
--5920--   Considering /usr/lib/valgrind/vgpreload_core-amd64-linux.so ..
--5920--   .. CRC mismatch (computed 50df1b30 wanted 4800a4cf)
--5920--    object doesn't have a symbol table
--5920-- Reading syms from /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so
--5920--   Considering /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so ..
--5920--   .. CRC mismatch (computed f893b962 wanted 95ee359e)
--5920--    object doesn't have a symbol table
==5920== WARNING: new redirection conflicts with existing -- ignoring it
--5920--     old: 0x04020d20 (strlen              ) R-> (0000.0) 0x580608c1 ???
--5920--     new: 0x04020d20 (strlen              ) R-> (2007.0) 0x04c34db0 strlen
--5920-- REDIR: 0x401d540 (ld-linux-x86-64.so.2:strcmp) redirected to 0x4c35ee0 (strcmp)
--5920-- REDIR: 0x4021260 (ld-linux-x86-64.so.2:mempcpy) redirected to 0x4c394f0 (mempcpy)
--5920-- Reading syms from /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25
--5920--    object doesn't have a symbol table
--5920-- Reading syms from /lib/x86_64-linux-gnu/libgcc_s.so.1
--5920--    object doesn't have a symbol table
--5920-- Reading syms from /lib/x86_64-linux-gnu/libc-2.27.so
--5920--   Considering /lib/x86_64-linux-gnu/libc-2.27.so ..
--5920--   .. CRC mismatch (computed f250d419 wanted 4aacab51)
--5920--   Considering /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.27.so ..
--5920--   .. CRC is valid
--5920-- Reading syms from /lib/x86_64-linux-gnu/libm-2.27.so
--5920--   Considering /lib/x86_64-linux-gnu/libm-2.27.so ..
--5920--   .. CRC mismatch (computed 4e7cf542 wanted 8d27f134)
--5920--   Considering /usr/lib/debug/lib/x86_64-linux-gnu/libm-2.27.so ..
--5920--   .. CRC is valid
--5920-- REDIR: 0x547da50 (libc.so.6:memmove) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547cd60 (libc.so.6:strncpy) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547dd30 (libc.so.6:strcasecmp) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547c7b0 (libc.so.6:strcat) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547cd90 (libc.so.6:rindex) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547f480 (libc.so.6:rawmemchr) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547dbc0 (libc.so.6:mempcpy) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547d9f0 (libc.so.6:bcmp) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547cd20 (libc.so.6:strncmp) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547c820 (libc.so.6:strcmp) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547db20 (libc.so.6:memset) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x549adb0 (libc.so.6:wcschr) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547ccc0 (libc.so.6:strnlen) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547c890 (libc.so.6:strcspn) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547dd80 (libc.so.6:strncasecmp) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547c860 (libc.so.6:strcpy) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547dec0 (libc.so.6:memcpy@@GLIBC_2.14) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547cdc0 (libc.so.6:strpbrk) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547c7e0 (libc.so.6:index) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547cc90 (libc.so.6:strlen) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x5487380 (libc.so.6:memrchr) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547ddd0 (libc.so.6:strcasecmp_l) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547d9c0 (libc.so.6:memchr) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x549bb70 (libc.so.6:wcslen) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547d070 (libc.so.6:strspn) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547dd00 (libc.so.6:stpncpy) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547dcd0 (libc.so.6:stpcpy) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547f4b0 (libc.so.6:strchrnul) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x547de20 (libc.so.6:strncasecmp_l) redirected to 0x4a2c6e0 (_vgnU_ifunc_wrapper)
--5920-- REDIR: 0x556d280 (libc.so.6:__strrchr_avx2) redirected to 0x4c34730 (rindex)
--5920-- REDIR: 0x5476020 (libc.so.6:malloc) redirected to 0x4c31aa0 (malloc)
--5920-- REDIR: 0x556d450 (libc.so.6:__strlen_avx2) redirected to 0x4c34cf0 (strlen)
--5920-- REDIR: 0x5569a60 (libc.so.6:__memcmp_avx2_movbe) redirected to 0x4c37e00 (bcmp)
--5920-- REDIR: 0x5488b30 (libc.so.6:__strcmp_sse2_unaligned) redirected to 0x4c35da0 (strcmp)
--5920-- REDIR: 0x4ed1280 (libstdc++.so.6:operator new(unsigned long)) redirected to 0x4c32110 (operator new(unsigned long))
--5920-- REDIR: 0x556d990 (libc.so.6:__memcpy_avx_unaligned_erms) redirected to 0x4c386e0 (memmove)
--5920-- REDIR: 0x547d5a0 (libc.so.6:__GI_strstr) redirected to 0x4c39760 (__strstr_sse2)
--5920-- REDIR: 0x4ed1330 (libstdc++.so.6:operator new[](unsigned long)) redirected to 0x4c32830 (operator new[](unsigned long))
--5920-- REDIR: 0x4ecf390 (libstdc++.so.6:operator delete(void*)) redirected to 0x4c331d0 (operator delete(void*))
--5920-- REDIR: 0x556d090 (libc.so.6:__strchrnul_avx2) redirected to 0x4c39020 (strchrnul)
--5920-- REDIR: 0x556d970 (libc.so.6:__mempcpy_avx_unaligned_erms) redirected to 0x4c39130 (mempcpy)
--5920-- REDIR: 0x55692e0 (libc.so.6:__memchr_avx2) redirected to 0x4c35f80 (memchr)
==5920== Invalid read of size 8
==5920==    at 0x10FCF7: _ZZN3pgm16BufferedPGMIndexIjjE5buildIN9__gnu_cxx17__normal_iteratorIPSt4pairIjjESt6vectorIS6_SaIS6_EEEEEEvT_SC_mmENKUlSC_E2_clImEEDaSC_ (pgm_index_buffered.hpp:168)
==5920==    by 0x11514A: unsigned long pgm::internal::make_segmentation<void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#4}, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#5}>(unsigned long, unsigned long, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#4}, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#5}) (piecewise_linear_model.hpp:313)
==5920==    by 0x10FF2C: unsigned long pgm::internal::make_segmentation_par<void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#4}, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#5}>(unsigned long, unsigned long, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#4}, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#5}) (piecewise_linear_model.hpp:346)
==5920==    by 0x10D23D: _ZZN3pgm16BufferedPGMIndexIjjE5buildIN9__gnu_cxx17__normal_iteratorIPSt4pairIjjESt6vectorIS6_SaIS6_EEEEEEvT_SC_mmENKUlSC_T0_T1_E_clImZNS2_ISB_EEvSC_SC_mmEUlSC_E2_ZNS2_ISB_EEvSC_SC_mmEUlSC_E3_EEDaSC_SD_SE_ (pgm_index_buffered.hpp:129)
==5920==    by 0x10D61E: void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long) (pgm_index_buffered.hpp:182)
==5920==    by 0x1225AC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::BufferedPGMIndex<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(unsigned long, unsigned long, float, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >) (pgm_index_buffered.hpp:275)
==5920==    by 0x121B26: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:39)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x688a230 is 0 bytes inside a block of size 16 free'd
==5920==    at 0x4C3323B: operator delete(void*) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x1134F7: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::deallocate(std::pair<unsigned int, unsigned int>*, unsigned long) (new_allocator.h:125)
==5920==    by 0x10EED2: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::deallocate(std::allocator<std::pair<unsigned int, unsigned int> >&, std::pair<unsigned int, unsigned int>*, unsigned long) (alloc_traits.h:462)
==5920==    by 0x10CE05: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_deallocate(std::pair<unsigned int, unsigned int>*, unsigned long) (stl_vector.h:180)
==5920==    by 0x10CAC4: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::~_Vector_base() (stl_vector.h:162)
==5920==    by 0x10B9D4: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::~vector() (stl_vector.h:435)
==5920==    by 0x10DAB3: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::~Segment() (pgm_index_buffered.hpp:630)
==5920==    by 0x11E33E: void std::_Destroy<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_construct.h:98)
==5920==    by 0x11D1B6: void std::_Destroy_aux<false>::__destroy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_construct.h:108)
==5920==    by 0x11A7B2: void std::_Destroy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_construct.h:137)
==5920==    by 0x115C64: void std::_Destroy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_construct.h:206)
==5920==    by 0x11054C: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:218)
==5920==  Block was alloc'd at
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== Invalid read of size 8
==5920==    at 0x10DACC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc20 is 0 bytes after a block of size 17,184 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== Invalid read of size 4
==5920==    at 0x10DADA: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc28 is 8 bytes after a block of size 17,184 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== Invalid read of size 4
==5920==    at 0x10DAE8: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc2c is 12 bytes after a block of size 17,184 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== Invalid read of size 4
==5920==    at 0x10DAFA: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc30 is 16 bytes after a block of size 17,184 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== Invalid read of size 8
==5920==    at 0x10DB08: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc34 is 20 bytes after a block of size 17,184 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== Invalid read of size 8
==5920==    at 0x10DB18: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc3c is 28 bytes after a block of size 17,184 in arena "client"
==5920== 
==5920== Invalid read of size 4
==5920==    at 0x10DB28: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc44 is 28 bytes before a block of size 14,016 in arena "client"
==5920== 
==5920== Invalid read of size 8
==5920==    at 0x10DB3A: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc48 is 24 bytes before a block of size 14,016 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== Invalid read of size 8
==5920==    at 0x10BBD8: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::size() const (stl_vector.h:671)
==5920==    by 0x110BA2: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::operator=(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (vector.tcc:203)
==5920==    by 0x10DB60: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc58 is 8 bytes before a block of size 14,016 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== Invalid read of size 8
==5920==    at 0x10BBE3: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::size() const (stl_vector.h:671)
==5920==    by 0x110BA2: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::operator=(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (vector.tcc:203)
==5920==    by 0x10DB60: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc50 is 16 bytes before a block of size 14,016 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== Invalid read of size 8
==5920==    at 0x115E17: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::end() const (stl_vector.h:591)
==5920==    by 0x110BCD: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::operator=(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (vector.tcc:206)
==5920==    by 0x10DB60: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc58 is 8 bytes before a block of size 14,016 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== Invalid read of size 8
==5920==    at 0x115DB1: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::begin() const (stl_vector.h:573)
==5920==    by 0x110BDC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::operator=(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (vector.tcc:206)
==5920==    by 0x10DB60: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc50 is 16 bytes before a block of size 14,016 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
--5920-- REDIR: 0x5477c50 (libc.so.6:realloc) redirected to 0x4c33cb0 (realloc)
--5920-- REDIR: 0x5476910 (libc.so.6:free) redirected to 0x4c32cd0 (free)
==5920== 
==5920== Process terminating with default action of signal 6 (SIGABRT)
==5920==    at 0x541DE87: raise (raise.c:51)
==5920==    by 0x541F7F0: abort (abort.c:79)
==5920==    by 0x4ECA956: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x4ED0AE5: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x4ED0B20: std::terminate() (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x4ED0D53: __cxa_throw (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x4EF9011: std::__throw_bad_alloc() (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x118155: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:102)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115FBF: std::pair<unsigned int, unsigned int>* std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int> const*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(unsigned long, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int> const*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int> const*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >) (stl_vector.h:1260)
==5920==    by 0x110BF2: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::operator=(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (vector.tcc:206)
==5920== 
==5920== HEAP SUMMARY:
==5920==     in use at exit: 2,821,400 bytes in 286 blocks
==5920==   total heap usage: 579,724 allocs, 579,438 frees, 1,996,144,832 bytes allocated
==5920== 
==5920== Searching for pointers to 286 not-freed blocks
==5920== Checked 2,573,864 bytes
==5920== 
==5920== 20 bytes in 1 blocks are still reachable in loss record 1 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x123421: __gnu_cxx::new_allocator<int>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1232CB: std::allocator_traits<std::allocator<int> >::allocate(std::allocator<int>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x123131: std::_Vector_base<int, std::allocator<int> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x122E55: void std::vector<int, std::allocator<int> >::_M_range_initialize<int const*>(int const*, int const*, std::forward_iterator_tag) (stl_vector.h:1328)
==5920==    by 0x122891: std::vector<int, std::allocator<int> >::vector(std::initializer_list<int>, std::allocator<int> const&) (stl_vector.h:387)
==5920==    by 0x121CD5: main (shape_experiments.cpp:67)
==5920== 
==5920== 36 bytes in 1 blocks are still reachable in loss record 2 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x12337F: __gnu_cxx::new_allocator<float>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x12320D: std::allocator_traits<std::allocator<float> >::allocate(std::allocator<float>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x123007: std::_Vector_base<float, std::allocator<float> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x122C81: void std::vector<float, std::allocator<float> >::_M_range_initialize<float const*>(float const*, float const*, std::forward_iterator_tag) (stl_vector.h:1328)
==5920==    by 0x122713: std::vector<float, std::allocator<float> >::vector(std::initializer_list<float>, std::allocator<float> const&) (stl_vector.h:387)
==5920==    by 0x121C7F: main (shape_experiments.cpp:66)
==5920== 
==5920== 64 bytes in 1 blocks are still reachable in loss record 3 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DC07: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:195)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== 80 bytes in 1 blocks are still reachable in loss record 4 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115FBF: std::pair<unsigned int, unsigned int>* std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int> const*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(unsigned long, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int> const*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int> const*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >) (stl_vector.h:1260)
==5920==    by 0x110BF2: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::operator=(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (vector.tcc:206)
==5920==    by 0x112281: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:471)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x1124E2: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:497)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920== 
==5920== 96 bytes in 1 blocks are still reachable in loss record 5 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11F088: __gnu_cxx::new_allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11CD85: std::allocator_traits<std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >::allocate(std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x119E7D: std::_Vector_base<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x114B7F: void std::vector<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >::_M_realloc_insert<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&>(__gnu_cxx::__normal_iterator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >*, std::vector<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > > >, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:406)
==5920==    by 0x10FB6F: std::vector<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >::push_back(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (stl_vector.h:948)
==5920==    by 0x10D646: void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long) (pgm_index_buffered.hpp:183)
==5920==    by 0x1225AC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::BufferedPGMIndex<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(unsigned long, unsigned long, float, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >) (pgm_index_buffered.hpp:275)
==5920==    by 0x121B26: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:39)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== 96 bytes in 1 blocks are still reachable in loss record 6 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x119FFA: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x114E5A: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_Vector_base(unsigned long, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> const&) (stl_vector.h:138)
==5920==    by 0x10FBDA: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::vector(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (stl_vector.h:328)
==5920==    by 0x119C86: void __gnu_cxx::new_allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >::construct<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&>(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (new_allocator.h:136)
==5920==    by 0x114AB4: void std::allocator_traits<std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >::construct<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&>(std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >&, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (alloc_traits.h:475)
==5920==    by 0x10FB37: std::vector<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >::push_back(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (stl_vector.h:943)
==5920==    by 0x10D646: void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long) (pgm_index_buffered.hpp:183)
==5920==    by 0x1225AC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::BufferedPGMIndex<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(unsigned long, unsigned long, float, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >) (pgm_index_buffered.hpp:275)
==5920== 
==5920== 136 bytes in 1 blocks are possibly lost in loss record 7 of 18
==5920==    at 0x4C31B0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x4ECF8FF: __cxa_allocate_exception (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x4EF8FED: std::__throw_bad_alloc() (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x118155: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:102)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115FBF: std::pair<unsigned int, unsigned int>* std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int> const*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(unsigned long, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int> const*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int> const*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >) (stl_vector.h:1260)
==5920==    by 0x110BF2: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::operator=(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (vector.tcc:206)
==5920==    by 0x10DB60: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920== 
==5920== 552 bytes in 1 blocks are still reachable in loss record 8 of 18
==5920==    at 0x4C31B0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x545DDF9: __fopen_internal (iofopen.c:65)
==5920==    by 0x545DDF9: fopen@@GLIBC_2.2.5 (iofopen.c:89)
==5920==    by 0x4EF1E4F: std::__basic_file<char>::open(char const*, std::_Ios_Openmode, int) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x4F320D9: std::basic_filebuf<char, std::char_traits<char> >::open(char const*, std::_Ios_Openmode) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x4F322FF: std::basic_ofstream<char, std::char_traits<char> >::open(char const*, std::_Ios_Openmode) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x121D46: main (shape_experiments.cpp:74)
==5920== 
==5920== 672 bytes in 1 blocks are still reachable in loss record 9 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x119FFA: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x114E5A: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_Vector_base(unsigned long, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> const&) (stl_vector.h:138)
==5920==    by 0x10FBDA: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::vector(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (stl_vector.h:328)
==5920==    by 0x119C86: void __gnu_cxx::new_allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >::construct<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&>(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (new_allocator.h:136)
==5920==    by 0x114AB4: void std::allocator_traits<std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >::construct<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&>(std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >&, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (alloc_traits.h:475)
==5920==    by 0x114BC8: void std::vector<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >::_M_realloc_insert<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&>(__gnu_cxx::__normal_iterator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >*, std::vector<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > > >, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:415)
==5920==    by 0x10FB6F: std::vector<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >, std::allocator<std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >::push_back(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (stl_vector.h:948)
==5920==    by 0x10D646: void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long) (pgm_index_buffered.hpp:183)
==5920== 
==5920== 3,552 bytes in 1 blocks are still reachable in loss record 10 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x1124E2: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:497)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920== 
==5920== 4,592 bytes in 30 blocks are still reachable in loss record 11 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA60: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== 7,336 bytes in 19 blocks are still reachable in loss record 12 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10CF31: void std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_realloc_insert<std::pair<unsigned int, unsigned int> const&>(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, std::pair<unsigned int, unsigned int> const&) (vector.tcc:406)
==5920==    by 0x1110BF: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::insert(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int> const*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, std::pair<unsigned int, unsigned int> const&) (vector.tcc:143)
==5920==    by 0x10E13E: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::insert(std::pair<unsigned int, unsigned int> const&) (pgm_index_buffered.hpp:805)
==5920==    by 0x10C4E6: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:369)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== 8,192 bytes in 1 blocks are still reachable in loss record 13 of 18
==5920==    at 0x4C3289F: operator new[](unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x4F2DFE7: std::basic_filebuf<char, std::char_traits<char> >::_M_allocate_internal_buffer() (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x4F320F1: std::basic_filebuf<char, std::char_traits<char> >::open(char const*, std::_Ios_Openmode) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x4F322FF: std::basic_ofstream<char, std::char_traits<char> >::open(char const*, std::_Ios_Openmode) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25)
==5920==    by 0x121D46: main (shape_experiments.cpp:74)
==5920== 
==5920== 17,184 bytes in 1 blocks are still reachable in loss record 14 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== 196,592 bytes in 13 blocks are still reachable in loss record 15 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10CF31: void std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_realloc_insert<std::pair<unsigned int, unsigned int> const&>(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, std::pair<unsigned int, unsigned int> const&) (vector.tcc:406)
==5920==    by 0x1110BF: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::insert(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int> const*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, std::pair<unsigned int, unsigned int> const&) (vector.tcc:143)
==5920==    by 0x10E17A: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::insert(std::pair<unsigned int, unsigned int> const&) (pgm_index_buffered.hpp:811)
==5920==    by 0x10C4E6: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:369)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== 733,624 bytes in 210 blocks are still reachable in loss record 16 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== 800,000 bytes in 1 blocks are still reachable in loss record 17 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x121EA7: main (shape_experiments.cpp:83)
==5920== 
==5920== 1,048,576 bytes in 1 blocks are still reachable in loss record 18 of 18
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10CF31: void std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_realloc_insert<std::pair<unsigned int, unsigned int> const&>(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, std::pair<unsigned int, unsigned int> const&) (vector.tcc:406)
==5920==    by 0x10BE0F: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::push_back(std::pair<unsigned int, unsigned int> const&) (stl_vector.h:948)
==5920==    by 0x121A04: get_random_data(unsigned long, int) (shape_experiments.cpp:24)
==5920==    by 0x121E8E: main (shape_experiments.cpp:82)
==5920== 
==5920== LEAK SUMMARY:
==5920==    definitely lost: 0 bytes in 0 blocks
==5920==    indirectly lost: 0 bytes in 0 blocks
==5920==      possibly lost: 136 bytes in 1 blocks
==5920==    still reachable: 2,821,264 bytes in 285 blocks
==5920==         suppressed: 0 bytes in 0 blocks
==5920== 
==5920== ERROR SUMMARY: 14 errors from 14 contexts (suppressed: 0 from 0)
==5920== 
==5920== 1 errors in context 1 of 14:
==5920== Invalid read of size 8
==5920==    at 0x115DB1: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::begin() const (stl_vector.h:573)
==5920==    by 0x110BDC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::operator=(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (vector.tcc:206)
==5920==    by 0x10DB60: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc50 is 16 bytes before a block of size 14,016 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== 
==5920== 1 errors in context 2 of 14:
==5920== Invalid read of size 8
==5920==    at 0x115E17: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::end() const (stl_vector.h:591)
==5920==    by 0x110BCD: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::operator=(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (vector.tcc:206)
==5920==    by 0x10DB60: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc58 is 8 bytes before a block of size 14,016 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== 
==5920== 1 errors in context 3 of 14:
==5920== Invalid read of size 8
==5920==    at 0x10BBE3: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::size() const (stl_vector.h:671)
==5920==    by 0x110BA2: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::operator=(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (vector.tcc:203)
==5920==    by 0x10DB60: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc50 is 16 bytes before a block of size 14,016 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== 
==5920== 1 errors in context 4 of 14:
==5920== Invalid read of size 8
==5920==    at 0x10BBD8: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::size() const (stl_vector.h:671)
==5920==    by 0x110BA2: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::operator=(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (vector.tcc:203)
==5920==    by 0x10DB60: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc58 is 8 bytes before a block of size 14,016 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== 
==5920== 1 errors in context 5 of 14:
==5920== Invalid read of size 8
==5920==    at 0x10DB3A: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc48 is 24 bytes before a block of size 14,016 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== 
==5920== 1 errors in context 6 of 14:
==5920== Invalid read of size 4
==5920==    at 0x10DB28: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc44 is 28 bytes before a block of size 14,016 in arena "client"
==5920== 
==5920== 
==5920== 1 errors in context 7 of 14:
==5920== Invalid read of size 8
==5920==    at 0x10DB18: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc3c is 28 bytes after a block of size 17,184 in arena "client"
==5920== 
==5920== 
==5920== 1 errors in context 8 of 14:
==5920== Invalid read of size 8
==5920==    at 0x10DB08: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc34 is 20 bytes after a block of size 17,184 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== 
==5920== 1 errors in context 9 of 14:
==5920== Invalid read of size 4
==5920==    at 0x10DAFA: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc30 is 16 bytes after a block of size 17,184 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== 
==5920== 1 errors in context 10 of 14:
==5920== Invalid read of size 4
==5920==    at 0x10DAE8: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc2c is 12 bytes after a block of size 17,184 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== 
==5920== 1 errors in context 11 of 14:
==5920== Invalid read of size 4
==5920==    at 0x10DADA: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc28 is 8 bytes after a block of size 17,184 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== 
==5920== 1 errors in context 12 of 14:
==5920== Invalid read of size 8
==5920==    at 0x10DACC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::operator=(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x10DE23: pgm::BufferedPGMIndex<unsigned int, unsigned int>::by_level_segment_ix_for_key(unsigned int const&, unsigned long) (pgm_index_buffered.hpp:215)
==5920==    by 0x10C492: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:367)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x5d2cc20 is 0 bytes after a block of size 17,184 alloc'd
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x11E38A: __gnu_cxx::new_allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x11BE4D: std::allocator_traits<std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::allocate(std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x1186B3: std::_Vector_base<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x115B39: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(unsigned long, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_vector.h:1260)
==5920==    by 0x110427: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:206)
==5920==    by 0x1124B0: pgm::BufferedPGMIndex<unsigned int, unsigned int>::internal_insert(unsigned long, unsigned long, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >&) (pgm_index_buffered.hpp:491)
==5920==    by 0x10E3FC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::split(unsigned long, unsigned long) (pgm_index_buffered.hpp:555)
==5920==    by 0x10C504: pgm::BufferedPGMIndex<unsigned int, unsigned int>::insert(unsigned int, unsigned int) (pgm_index_buffered.hpp:372)
==5920==    by 0x121B84: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:48)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920== 
==5920== 
==5920== 1 errors in context 13 of 14:
==5920== Invalid read of size 8
==5920==    at 0x10FCF7: _ZZN3pgm16BufferedPGMIndexIjjE5buildIN9__gnu_cxx17__normal_iteratorIPSt4pairIjjESt6vectorIS6_SaIS6_EEEEEEvT_SC_mmENKUlSC_E2_clImEEDaSC_ (pgm_index_buffered.hpp:168)
==5920==    by 0x11514A: unsigned long pgm::internal::make_segmentation<void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#4}, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#5}>(unsigned long, unsigned long, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#4}, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#5}) (piecewise_linear_model.hpp:313)
==5920==    by 0x10FF2C: unsigned long pgm::internal::make_segmentation_par<void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#4}, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#5}>(unsigned long, unsigned long, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#4}, void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long)::{lambda(auto:1)#5}) (piecewise_linear_model.hpp:346)
==5920==    by 0x10D23D: _ZZN3pgm16BufferedPGMIndexIjjE5buildIN9__gnu_cxx17__normal_iteratorIPSt4pairIjjESt6vectorIS6_SaIS6_EEEEEEvT_SC_mmENKUlSC_T0_T1_E_clImZNS2_ISB_EEvSC_SC_mmEUlSC_E2_ZNS2_ISB_EEvSC_SC_mmEUlSC_E3_EEDaSC_SD_SE_ (pgm_index_buffered.hpp:129)
==5920==    by 0x10D61E: void pgm::BufferedPGMIndex<unsigned int, unsigned int>::build<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, unsigned long, unsigned long) (pgm_index_buffered.hpp:182)
==5920==    by 0x1225AC: pgm::BufferedPGMIndex<unsigned int, unsigned int>::BufferedPGMIndex<__gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > > >(unsigned long, unsigned long, float, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >, __gnu_cxx::__normal_iterator<std::pair<unsigned int, unsigned int>*, std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > >) (pgm_index_buffered.hpp:275)
==5920==    by 0x121B26: get_number_of_segments(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >, unsigned long, unsigned long, unsigned long, float) (shape_experiments.cpp:39)
==5920==    by 0x121EDF: main (shape_experiments.cpp:83)
==5920==  Address 0x688a230 is 0 bytes inside a block of size 16 free'd
==5920==    at 0x4C3323B: operator delete(void*) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x1134F7: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::deallocate(std::pair<unsigned int, unsigned int>*, unsigned long) (new_allocator.h:125)
==5920==    by 0x10EED2: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::deallocate(std::allocator<std::pair<unsigned int, unsigned int> >&, std::pair<unsigned int, unsigned int>*, unsigned long) (alloc_traits.h:462)
==5920==    by 0x10CE05: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_deallocate(std::pair<unsigned int, unsigned int>*, unsigned long) (stl_vector.h:180)
==5920==    by 0x10CAC4: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::~_Vector_base() (stl_vector.h:162)
==5920==    by 0x10B9D4: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::~vector() (stl_vector.h:435)
==5920==    by 0x10DAB3: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::~Segment() (pgm_index_buffered.hpp:630)
==5920==    by 0x11E33E: void std::_Destroy<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_construct.h:98)
==5920==    by 0x11D1B6: void std::_Destroy_aux<false>::__destroy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_construct.h:108)
==5920==    by 0x11A7B2: void std::_Destroy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > > >(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >) (stl_construct.h:137)
==5920==    by 0x115C64: void std::_Destroy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_construct.h:206)
==5920==    by 0x11054C: std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> >::operator=(std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > const&) (vector.tcc:218)
==5920==  Block was alloc'd at
==5920==    at 0x4C3217F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==5920==    by 0x118165: __gnu_cxx::new_allocator<std::pair<unsigned int, unsigned int> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==5920==    by 0x1134A3: std::allocator_traits<std::allocator<std::pair<unsigned int, unsigned int> > >::allocate(std::allocator<std::pair<unsigned int, unsigned int> >&, unsigned long) (alloc_traits.h:436)
==5920==    by 0x10EE6D: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_allocate(unsigned long) (stl_vector.h:172)
==5920==    by 0x10EB62: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_M_create_storage(unsigned long) (stl_vector.h:187)
==5920==    by 0x10CA60: std::_Vector_base<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::_Vector_base(unsigned long, std::allocator<std::pair<unsigned int, unsigned int> > const&) (stl_vector.h:138)
==5920==    by 0x1108FC: std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > >::vector(std::vector<std::pair<unsigned int, unsigned int>, std::allocator<std::pair<unsigned int, unsigned int> > > const&) (stl_vector.h:328)
==5920==    by 0x10DA45: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment::Segment(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (pgm_index_buffered.hpp:630)
==5920==    by 0x11F17B: void std::_Construct<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&>(pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const&) (stl_construct.h:75)
==5920==    by 0x11CE73: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy<false>::__uninit_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:83)
==5920==    by 0x11A087: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::uninitialized_copy<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*) (stl_uninitialized.h:134)
==5920==    by 0x114F54: pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment* std::__uninitialized_copy_a<__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>(__gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, __gnu_cxx::__normal_iterator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment const*, std::vector<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment> > >, pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment*, std::allocator<pgm::BufferedPGMIndex<unsigned int, unsigned int>::Segment>&) (stl_uninitialized.h:289)
==5920== 
==5920== ERROR SUMMARY: 14 errors from 14 contexts (suppressed: 0 from 0)
